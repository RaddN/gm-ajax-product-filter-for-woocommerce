jQuery(document).ready(function(e){let t,r;"undefined"!=typeof dapfforwc_data&&dapfforwc_data.dapfforwc_advance_settings&&(t=dapfforwc_data.dapfforwc_advance_settings),"undefined"!=typeof dapfforwc_data&&dapfforwc_data.dapfforwc_options&&(r=dapfforwc_data.dapfforwc_options);var i,l=e(".rfilterbuttons").attr("id"),n=window.location.pathname,c=n.replace(/^\/|\/$/g,"");let o=a();function u(t){if(t.preventDefault(),!function t(){let r=e("#product-filter input:checked").length>0,i=e("#product-filter select").filter(function(){return this.value}).length>0,l=e('#product-filter input[type="text"]').filter(function(){return""!==this.value.trim()}).length>0,n=e('#product-filter input[type="number"]').filter(function(){return""!==this.value.trim()}).length>0,c=e('#product-filter input[type="range"]').filter(function(){return""!==this.value.trim()}).length>0;return r||i||l||n||c}())return location.reload();o=a(),$(),e("#roverlay").show(),e("#loader").show(),g()}function a(){let t=[];return t=t.concat(e("#product-filter input:checked").map(function(){return e(this).val()}).get()),e("#product-filter select").each(function(){let r=e(this).val();r&&(t=t.concat(r))}),t}function p(){c.split("/").forEach(t=>{e(`input[value="${t}"]`).length?e(`input[value="${t}"]`).attr("checked",!0):e(`select option[value="${t}"]`).length&&e(`select option[value="${t}"]`).prop("selected",!0)})}e("#product-filter, .rfilterbuttons").on("change",u),e("#product-filter, .rfilterbuttons").on("submit",u),e(".woocommerce-ordering select").on("change",function(t){t.preventDefault(),i=e(this).val(),g()}),e(".woocommerce-ordering").on("submit",function(e){e.preventDefault()}),g(),p();let s=t?t.product_selector??"ul.products":"ul.products",d=t?t.pagination_selector??"ul.page-numbers":"ul.page-numbers",f=e("#product-filter").data("product_selector"),h=e("#product-filter").data("pagination_selector");function g(t=1){p(),e.post(dapfforwc_ajax.ajax_url,function t(){let r="/"===n?n:n.replace(/^\/|\/$/g,""),i=e("#product-filter").serialize(),l=document.querySelectorAll(".range-input input"),c=document.querySelectorAll(".price-input input"),o=document.querySelector(".slider .progress"),u=l[0]?parseInt(l[0].value):0,a=l[1]?parseInt(l[1].value):0,p=l[0]?parseInt(l[0].value):0;v(`$${u}`,`$${a}`),l.forEach(e=>{e.addEventListener("input",e=>{u=parseInt(l[0].value)||0,a=parseInt(l[1].value)||0,v(`$${u}`,`$${a}`),c[0].value=u,c[1].value=a,o.style.left=(u-p)/(l[0].max-p)*100+"%",o.style.right=100-a/l[1].max*100+"%"})}),c.forEach(e=>{e.addEventListener("input",e=>{let t=parseInt(c[0].value),r=parseInt(c[1].value);"input-min"===e.target.className?(l[0].value=t,o.style.left=t/l[0].max*100+"%"):(l[1].value=r,o.style.right=100-r/l[1].max*100+"%")})});let s="";return u&&(s+=`&min_price=${encodeURIComponent(u)}`),a&&(s+=`&max_price=${encodeURIComponent(a)}`),i+s+`&current-page=${encodeURIComponent(r)}`}()+`&selectedvalues=${o}&orderby=${i}&paged=${t}&action=dapfforwc_filter_products`,function(t){e("#roverlay").hide(),e("#loader").hide(),t.success?(e(f??s).html(t.data.products),e(".woocommerce-result-count").text(`${t.data.total_product_fetch} results found`),e("#rcountproduct").text(`show(${t.data.total_product_fetch})`),"on"===r.update_filter_options&&(e("#product-filter div").remove(),e("form#product-filter").append(t.data.filter_options)),e(h??d).html(t.data.pagination),$()):console.error("Error:",t.message)}).fail(m)}function v(t,r){var i=e("<style></style>");i.text(`
            .progress-percentage:before { 
                content: "${t}"; 
            }
            .progress-percentage:after { 
                content: "${r}"; 
            }
        `),e("head").append(i)}function m(t,r,i){e("#roverlay").hide(),e("#loader").hide(),console.error("AJAX Error:",r,i)}function $(){let t=e(".rfilterbuttons ul").empty();e("#product-filter #"+l+" input").each(function(){let r=e(this).val(),i=e(this).is(":checked"),l=this.type;t.append(k(r,i,l))}),e("#product-filter #"+l+" option").each(function(r){if(0===r)return;let i=e(this).val(),l=e(this).is(":checked"),n=this.type;t.append(k(i,l,n))}),e(".rfilterbuttons ul").off("click","li").on("click","li",function(){let t=e(this).find("input");t.prop("checked",!t.is(":checked")).trigger("change"),e(this).toggleClass("checked",t.is(":checked"))}),e("#"+l+" input").on("change",function(){let t=e(`.rfilterbuttons ul li input[value="${e(this).val()}"]`);t.prop("checked",e(this).is(":checked")).closest("li").toggleClass("checked",e(this).is(":checked"))})}function k(t,r,i){let n=t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return e("<li></li>").addClass(r?"checked":"").append(e("<input>",{name:"attribute["+l+"][]",id:"text_"+t,type:"checkbox",value:t,checked:r}).on("change",y),e("<label></label>",{for:"text_"+t,text:n}))}function y(){e(`#product-filter #${l} input[value="${e(this).val()}"]`).prop("checked",e(this).is(":checked")),e(`#product-filter #${l} select option[value="${e(this).val()}"]`).prop("selected",e(this).is(":checked"))}e("#product-filter").length&&e(document).on("click",`${h??d} a.page-numbers`,function(t){t.preventDefault();let r=e(this).attr("href"),i=new URL(r).searchParams.get("paged");e("#roverlay").show(),e("#loader").show(),g(i)}),e(document).on("click","#reset-rating",function(t){t.preventDefault(),e('input[name="rating[]"]').prop("checked",!1),g()}),function t(){for(let r of(e(".rfilterselected ul").empty(),o))e(".rfilterselected ul").append(`
            <li class="checked">
                <input id="selected_${r}" type="checkbox" value="${r}" checked>
                <label for="selected_${r}">${r.replace(/-/g," ")}</label>
                <label style="font-size:12px;margin-left:5px;">x</label>
            </li>`)}(),$(),e(".rfilterselected").on("change","li",function(t){let r=e(this).find('input[type="checkbox"]').val();e(`#product-filter input[value="${r}"]`).prop("checked",!1),u(t)})}),jQuery(document).ready(function(e){function t(){return 768>=e(window).width()}function r(){t()&&(e("#product-filter .filter-group div .title").each(function(){e(this).text(e(this).text().split(" ").pop())}),e("#product-filter .items").hide())}function i(){2===e("form#product-filter").children().length&&(e(productSelector_shortcode??product_selector).html("<p>No products found</p>"),e(paginationSelector_shortcode??pagination_selector).html(""))}r(),e(document).ajaxComplete(function(){r(),i()}),e("#product-filter").on("click",".title",function(r){t()&&(r.stopPropagation(),e("#product-filter .items").hide(),e(this).next(".items").slideToggle())}),e(document).on("click",function(){t()&&e(".items").hide()}),i()}),jQuery(document).ready(function(e){e(".show-sub-cata").on("click",function(t){t.preventDefault();let r=e(this).closest("a").next(".child-categories");r.slideToggle(()=>{e(this).text(r.is(":visible")?"-":"+")})})});